{"title":"Question 4","markdown":{"yaml":{"format":{"html":{"toc":true,"toc-depth":3,"theme":"cosmo","number-sections":false,"output-file":"assignments.hw3.q4.html"}},"code-block-background":true,"include-in-header":{"text":"<link rel = \"icon\" href = \"data:,\" />"},"toc-title-numbers":false,"number-depth":0},"headingText":"Question 4","containsRefs":false,"markdown":"\n<style></style><style>.printedClojure .sourceCode {\n  background-color: transparent;\n  border-style: none;\n}\n</style><style>.clay-limit-image-width .clay-image {max-width: 100%}\n.clay-side-by-side .sourceCode {margin: 0}\n.clay-side-by-side {margin: 1em 0}\n</style>\n<script src=\"assignments.hw3.q4_files/md-default2.js\" type=\"text/javascript\"></script><script src=\"assignments.hw3.q4_files/md-default3.js\" type=\"text/javascript\"></script><script src=\"assignments.hw3.q4_files/katex4.js\" type=\"text/javascript\"></script><script src=\"assignments.hw3.q4_files/vega5.js\" type=\"text/javascript\"></script><script src=\"assignments.hw3.q4_files/vega6.js\" type=\"text/javascript\"></script><script src=\"assignments.hw3.q4_files/vega7.js\" type=\"text/javascript\"></script><link href=\"https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css\" rel=\"stylesheet\" type=\"text/css\" />\n\n::: {.sourceClojure}\n```clojure\n(ns assignments.hw3.q4\n   (:require\n    [assignments.hw3.utils :refer :all]\n    [tablecloth.api :as tc]\n    [scicloj.hanamicloth.v1.api :as haclo]))\n```\n:::\n\n\n---\n\n#### *4) Two players, A and B, alternately and independently flip a coin and the first player to obtain a head wins. Assume player A flips first.*\n\n***a) If the coin is fair, what is the probability that A wins?***\n\nTo solve this problem, let's consider the possible scenarios:\n\n1. A wins on the first flip (probability 1/2)\n2. If A doesn't win on the first flip, B flips. If B doesn't win, we're back to A's turn, but now in the same situation as at the start of the game.\n\nLet p be the probability that A wins. We can write an equation:\n\n$$p = \\frac{1}{2} + \\frac{1}{2} \\cdot \\frac{1}{2} \\cdot p$$\n\nThis equation states that A wins either on the first flip (1/2) or if both A and B get tails (1/2 * 1/2), bringing us back to the original situation (p).\n\nSolving this equation:\n\n$$p = \\frac{1}{2} + \\frac{1}{4}p$$\n\n$$\\frac{3}{4}p = \\frac{1}{2}$$\n\n$$p = \\frac{2}{3}$$\n\n\n::: {.sourceClojure}\n```clojure\n(def probability-a-wins\n   (fn [p]\n     (/ p (- 1 (* (- 1 p) (- 1 p))))))\n```\n:::\n\n\n\n::: {.sourceClojure}\n```clojure\n(def probability-a-wins-fair\n   (probability-a-wins 0.5))\n```\n:::\n\n\n\n::: {.sourceClojure}\n```clojure\n(answer\n  (str \"The probability that A wins with a fair coin is \"\n       (format \"%.5f\" probability-a-wins-fair)))\n```\n:::\n\n\n> <span style=\"color: black; font-size: 1.5em;\">**The probability that A wins with a fair coin is 0.66667**</span>\n\nWe can verify this result by simulating many games:\n\n\n::: {.sourceClojure}\n```clojure\n(comment\n   (defn simulate-game []\n     (loop [player :A]\n       (if (= (rand-int 2) 0)                          ; 0 represents heads\n         player\n         (recur (if (= player :A) :B :A))))))\n```\n:::\n\n\n\n::: {.sourceClojure}\n```clojure\n(comment\n   (defn simulate-many-games [n]\n     (let [results (repeatedly n simulate-game)\n           a-wins (count (filter #(= % :A) results))]\n       (double (/ a-wins n)))))\n```\n:::\n\n\n\n::: {.sourceClojure}\n```clojure\n(let [num-simulations 1000000\n       simulated-prob (simulate-many-games num-simulations)]\n   (answer\n    (str \"Simulated probability after \" num-simulations \" games: \" (format \"%.4f\" simulated-prob))))\n```\n:::\n\n\n> <span style=\"color: black; font-size: 1.5em;\">**Simulated probability after 1000000 games: 0.6673**</span>\n\n***b) Suppose that P(head) = p, not necessarily 1/2. What is the probability that A wins?***\n\nLet's use the same approach as in part (a), but now with a general probability p for heads.\n\nLet q be the probability that A wins. We can write an equation:\n\n$$q = p + (1-p)(1-p)q$$\n\nThis equation states that A wins either on the first flip (p) or if both A and B get tails ((1-p)(1-p)), bringing us back to the original situation (q).\n\nSolving this equation:\n\n$$q = p + (1-p)^2q$$\n\n$$q - (1-p)^2q = p$$\n\n$$q(1 - (1-p)^2) = p$$\n\n$$q = \\frac{p}{1 - (1-p)^2}$$\n\n$$q = \\frac{p}{2p - p^2}$$\n\n$$q = \\frac{1}{2 - p}$$\n\nLet's calculate this probability for a few values of p:\n\n\n::: {.sourceClojure}\n```clojure\n(def probabilities\n   (map (fn [p] {:p p :probability (probability-a-wins p)})\n        [0.1 0.3 0.5 0.7 0.9]))\n```\n:::\n\n\n\n::: {.sourceClojure}\n```clojure\n(into [] probabilities)\n```\n:::\n\n\n\n::: {.printedClojure}\n```clojure\n[{:p 0.1, :probability 0.5263157894736844}\n {:p 0.3, :probability 0.5882352941176471}\n {:p 0.5, :probability 0.6666666666666666}\n {:p 0.7, :probability 0.7692307692307693}\n {:p 0.9, :probability 0.9090909090909092}]\n\n```\n:::\n\n\n**Interpretation:**\n\n1. When p = 0.5 (fair coin), we get the same result as in part (a): 2/3.\n2. As p increases, A's probability of winning increases, which makes sense as A gets the first chance to flip.\n3. As p approaches 1, A's probability of winning approaches 1, as A would almost certainly win on the first flip.\n4. As p approaches 0, A's probability of winning approaches 1/2, as the game would likely go on for many flips, slightly favoring A who goes first.\n\n\n::: {.sourceClojure}\n```clojure\n(answer \"The probability that A wins when P(head) = p is 1 / (2 - p)\")\n```\n:::\n\n\n> <span style=\"color: black; font-size: 1.5em;\">**The probability that A wins when P(head) = p is 1 / (2 - p)**</span>\n\n**Simulation Verification for Part b:**\n\nLet's create a simulation to verify our formula for different values of p:\n\n\n::: {.sourceClojure}\n```clojure\n(defn simulate-game-b [p]\n   (loop [player :A]\n     (if (< (rand) p)\n       player\n       (recur (if (= player :A) :B :A)))))\n```\n:::\n\n\n\n::: {.sourceClojure}\n```clojure\n(defn simulate-many-games-b [n p]\n   (let [results (repeatedly n #(simulate-game-b p))\n         a-wins (count (filter #(= % :A) results))]\n     (double (/ a-wins n))))\n```\n:::\n\n\n\n::: {.sourceClojure}\n```clojure\n(def simulation-results\n   (for [p [0.1 0.3 0.5 0.7 0.9]]\n     (let [theoretical (probability-a-wins p)\n           simulated (simulate-many-games-b 1000000 p)]\n       {:p p\n        :theoretical theoretical\n        :simulated simulated\n        :difference (- theoretical simulated)})))\n```\n:::\n\n\n\n::: {.sourceClojure}\n```clojure\n(answer \"Simulation results comparing theoretical and simulated probabilities:\")\n```\n:::\n\n\n> <span style=\"color: black; font-size: 1.5em;\">**Simulation results comparing theoretical and simulated probabilities:**</span>\n\n\n::: {.sourceClojure}\n```clojure\n(into [] simulation-results)\n```\n:::\n\n\n\n::: {.printedClojure}\n```clojure\n[{:p 0.1,\n  :theoretical 0.5263157894736844,\n  :simulated 0.526619,\n  :difference -3.032105263155449E-4}\n {:p 0.3,\n  :theoretical 0.5882352941176471,\n  :simulated 0.587536,\n  :difference 6.992941176471312E-4}\n {:p 0.5,\n  :theoretical 0.6666666666666666,\n  :simulated 0.666558,\n  :difference 1.0866666666664582E-4}\n {:p 0.7,\n  :theoretical 0.7692307692307693,\n  :simulated 0.76968,\n  :difference -4.4923076923075733E-4}\n {:p 0.9,\n  :theoretical 0.9090909090909092,\n  :simulated 0.909293,\n  :difference -2.0209090909084626E-4}]\n\n```\n:::\n\n\n**Conclusion:**\n\nWe have derived, implemented, and verified formulas for the probability of player A winning in a coin-flipping game against player B, both for a fair coin and for a coin with an arbitrary probability of heads. The simulation results closely match our theoretical calculations, confirming the accuracy of our formula.\n\nThis problem demonstrates the application of probability in game theory and illustrates how initial advantages (going first) can affect the overall probability of winning in sequential games. It also showcases how simulations can be used to verify theoretical results in probability problems.\n\nAdd the following code for plotting\n\n\n::: {.sourceClojure}\n```clojure\n(def simulation-data\n   (tc/dataset\n    (concat\n     (map #(assoc % :type \"Theoretical\" :probability (:theoretical %)) simulation-results)\n     (map #(assoc % :type \"Simulated\" :probability (:simulated %)) simulation-results))))\n```\n:::\n\n\n\n::: {.sourceClojure}\n```clojure\n(-> simulation-data\n     (haclo/layer-line\n      {:=x :p :=x-title \"P(Head)\" :=title \"Probability of A Winning\"\n       :=y :probability :=y-title \"Probability of A Winning\"\n       :=color :type})\n     (haclo/layer-point\n      {:=x :p       :=y :probability :=color :type}))\n```\n:::\n\n\n\n```{=html}\n<div><script>vegaEmbed(document.currentScript.parentElement, {\"encoding\":{\"x\":{\"field\":\"x\",\"type\":\"nominal\"},\"y\":{\"field\":\"y\",\"type\":\"nominal\"}},\"usermeta\":{\"embedOptions\":{\"renderer\":\"svg\"}},\"width\":400,\"background\":\"floralwhite\",\"layer\":[{\"mark\":{\"type\":\"line\",\"tooltip\":true},\"encoding\":{\"color\":{\"field\":\"type\",\"type\":\"nominal\"},\"x\":{\"field\":\"p\",\"type\":\"quantitative\",\"title\":\"P(Head)\"},\"y\":{\"field\":\"probability\",\"type\":\"quantitative\",\"title\":\"Probability of A Winning\"}},\"data\":{\"values\":\"p,theoretical,simulated,difference,type,probability\\n0.1,0.5263157894736844,0.526619,-3.032105263155449E-4,Theoretical,0.5263157894736844\\n0.3,0.5882352941176471,0.587536,6.992941176471312E-4,Theoretical,0.5882352941176471\\n0.5,0.6666666666666666,0.666558,1.0866666666664582E-4,Theoretical,0.6666666666666666\\n0.7,0.7692307692307693,0.76968,-4.4923076923075733E-4,Theoretical,0.7692307692307693\\n0.9,0.9090909090909092,0.909293,-2.0209090909084626E-4,Theoretical,0.9090909090909092\\n0.1,0.5263157894736844,0.526619,-3.032105263155449E-4,Simulated,0.526619\\n0.3,0.5882352941176471,0.587536,6.992941176471312E-4,Simulated,0.587536\\n0.5,0.6666666666666666,0.666558,1.0866666666664582E-4,Simulated,0.666558\\n0.7,0.7692307692307693,0.76968,-4.4923076923075733E-4,Simulated,0.76968\\n0.9,0.9090909090909092,0.909293,-2.0209090909084626E-4,Simulated,0.909293\\n\",\"format\":{\"type\":\"csv\"}}},{\"mark\":{\"type\":\"circle\",\"tooltip\":true},\"encoding\":{\"color\":{\"field\":\"type\",\"type\":\"nominal\"},\"x\":{\"field\":\"p\",\"type\":\"quantitative\"},\"y\":{\"field\":\"probability\",\"type\":\"quantitative\"}},\"data\":{\"values\":\"p,theoretical,simulated,difference,type,probability\\n0.1,0.5263157894736844,0.526619,-3.032105263155449E-4,Theoretical,0.5263157894736844\\n0.3,0.5882352941176471,0.587536,6.992941176471312E-4,Theoretical,0.5882352941176471\\n0.5,0.6666666666666666,0.666558,1.0866666666664582E-4,Theoretical,0.6666666666666666\\n0.7,0.7692307692307693,0.76968,-4.4923076923075733E-4,Theoretical,0.7692307692307693\\n0.9,0.9090909090909092,0.909293,-2.0209090909084626E-4,Theoretical,0.9090909090909092\\n0.1,0.5263157894736844,0.526619,-3.032105263155449E-4,Simulated,0.526619\\n0.3,0.5882352941176471,0.587536,6.992941176471312E-4,Simulated,0.587536\\n0.5,0.6666666666666666,0.666558,1.0866666666664582E-4,Simulated,0.666558\\n0.7,0.7692307692307693,0.76968,-4.4923076923075733E-4,Simulated,0.76968\\n0.9,0.9090909090909092,0.909293,-2.0209090909084626E-4,Simulated,0.909293\\n\",\"format\":{\"type\":\"csv\"}}}],\"height\":300,\"data\":{\"url\":\"assignments.hw3.q4_files\\/0.csv\",\"format\":{\"type\":\"csv\"}}});</script></div>\n```\n\n\nThe plot above shows the theoretical probability (line) and simulated results (points) for different values of P(Head). As we can see, the simulated results closely follow the theoretical curve, confirming the accuracy of our formula and simulation.\n\n\n::: {.sourceClojure}\n```clojure\n(def difference-data\n  (tc/dataset simulation-results))\n```\n:::\n\n\n\n::: {.sourceClojure}\n```clojure\n(-> difference-data\n     (haclo/layer-line\n      {:=x :p :=x-title \"P(Head)\" :=title \"Difference between Theoretical and Simulated Probabilities\"\n       :=y :difference :=y-title \"Theoretical - Simulated\"}))\n```\n:::\n\n\n\n```{=html}\n<div><script>vegaEmbed(document.currentScript.parentElement, {\"encoding\":{\"x\":{\"field\":\"x\",\"type\":\"nominal\"},\"y\":{\"field\":\"y\",\"type\":\"nominal\"}},\"usermeta\":{\"embedOptions\":{\"renderer\":\"svg\"}},\"width\":400,\"background\":\"floralwhite\",\"layer\":[{\"mark\":{\"type\":\"line\",\"tooltip\":true},\"encoding\":{\"x\":{\"field\":\"p\",\"type\":\"quantitative\",\"title\":\"P(Head)\"},\"y\":{\"field\":\"difference\",\"type\":\"quantitative\",\"title\":\"Theoretical - Simulated\"}},\"data\":{\"values\":\"p,theoretical,simulated,difference\\n0.1,0.5263157894736844,0.526619,-3.032105263155449E-4\\n0.3,0.5882352941176471,0.587536,6.992941176471312E-4\\n0.5,0.6666666666666666,0.666558,1.0866666666664582E-4\\n0.7,0.7692307692307693,0.76968,-4.4923076923075733E-4\\n0.9,0.9090909090909092,0.909293,-2.0209090909084626E-4\\n\",\"format\":{\"type\":\"csv\"}}}],\"height\":300,\"data\":{\"url\":\"assignments.hw3.q4_files\\/1.csv\",\"format\":{\"type\":\"csv\"}}});</script></div>\n```\n\n\nThis second plot shows the difference between the theoretical and simulated probabilities. The closer the line is to zero, the better the simulation matches the theoretical prediction. As we can see, the differences are very small, typically within ±0.005, which indicates a good agreement between theory and simulation.\n\n\n```{=html}\n<div style=\"background-color:grey;height:2px;width:100%;\"></div>\n```\n\n\n\n```{=html}\n<div><pre><small><small>source: <a href=\"https://github.com/adabwana/f24-m6410-hw3/blob/master/src/assignments/hw3/q4.clj\">src/assignments/hw3/q4.clj</a></small></small></pre></div>\n```\n","srcMarkdownNoYaml":"\n<style></style><style>.printedClojure .sourceCode {\n  background-color: transparent;\n  border-style: none;\n}\n</style><style>.clay-limit-image-width .clay-image {max-width: 100%}\n.clay-side-by-side .sourceCode {margin: 0}\n.clay-side-by-side {margin: 1em 0}\n</style>\n<script src=\"assignments.hw3.q4_files/md-default2.js\" type=\"text/javascript\"></script><script src=\"assignments.hw3.q4_files/md-default3.js\" type=\"text/javascript\"></script><script src=\"assignments.hw3.q4_files/katex4.js\" type=\"text/javascript\"></script><script src=\"assignments.hw3.q4_files/vega5.js\" type=\"text/javascript\"></script><script src=\"assignments.hw3.q4_files/vega6.js\" type=\"text/javascript\"></script><script src=\"assignments.hw3.q4_files/vega7.js\" type=\"text/javascript\"></script><link href=\"https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css\" rel=\"stylesheet\" type=\"text/css\" />\n\n::: {.sourceClojure}\n```clojure\n(ns assignments.hw3.q4\n   (:require\n    [assignments.hw3.utils :refer :all]\n    [tablecloth.api :as tc]\n    [scicloj.hanamicloth.v1.api :as haclo]))\n```\n:::\n\n\n## Question 4\n---\n\n#### *4) Two players, A and B, alternately and independently flip a coin and the first player to obtain a head wins. Assume player A flips first.*\n\n***a) If the coin is fair, what is the probability that A wins?***\n\nTo solve this problem, let's consider the possible scenarios:\n\n1. A wins on the first flip (probability 1/2)\n2. If A doesn't win on the first flip, B flips. If B doesn't win, we're back to A's turn, but now in the same situation as at the start of the game.\n\nLet p be the probability that A wins. We can write an equation:\n\n$$p = \\frac{1}{2} + \\frac{1}{2} \\cdot \\frac{1}{2} \\cdot p$$\n\nThis equation states that A wins either on the first flip (1/2) or if both A and B get tails (1/2 * 1/2), bringing us back to the original situation (p).\n\nSolving this equation:\n\n$$p = \\frac{1}{2} + \\frac{1}{4}p$$\n\n$$\\frac{3}{4}p = \\frac{1}{2}$$\n\n$$p = \\frac{2}{3}$$\n\n\n::: {.sourceClojure}\n```clojure\n(def probability-a-wins\n   (fn [p]\n     (/ p (- 1 (* (- 1 p) (- 1 p))))))\n```\n:::\n\n\n\n::: {.sourceClojure}\n```clojure\n(def probability-a-wins-fair\n   (probability-a-wins 0.5))\n```\n:::\n\n\n\n::: {.sourceClojure}\n```clojure\n(answer\n  (str \"The probability that A wins with a fair coin is \"\n       (format \"%.5f\" probability-a-wins-fair)))\n```\n:::\n\n\n> <span style=\"color: black; font-size: 1.5em;\">**The probability that A wins with a fair coin is 0.66667**</span>\n\nWe can verify this result by simulating many games:\n\n\n::: {.sourceClojure}\n```clojure\n(comment\n   (defn simulate-game []\n     (loop [player :A]\n       (if (= (rand-int 2) 0)                          ; 0 represents heads\n         player\n         (recur (if (= player :A) :B :A))))))\n```\n:::\n\n\n\n::: {.sourceClojure}\n```clojure\n(comment\n   (defn simulate-many-games [n]\n     (let [results (repeatedly n simulate-game)\n           a-wins (count (filter #(= % :A) results))]\n       (double (/ a-wins n)))))\n```\n:::\n\n\n\n::: {.sourceClojure}\n```clojure\n(let [num-simulations 1000000\n       simulated-prob (simulate-many-games num-simulations)]\n   (answer\n    (str \"Simulated probability after \" num-simulations \" games: \" (format \"%.4f\" simulated-prob))))\n```\n:::\n\n\n> <span style=\"color: black; font-size: 1.5em;\">**Simulated probability after 1000000 games: 0.6673**</span>\n\n***b) Suppose that P(head) = p, not necessarily 1/2. What is the probability that A wins?***\n\nLet's use the same approach as in part (a), but now with a general probability p for heads.\n\nLet q be the probability that A wins. We can write an equation:\n\n$$q = p + (1-p)(1-p)q$$\n\nThis equation states that A wins either on the first flip (p) or if both A and B get tails ((1-p)(1-p)), bringing us back to the original situation (q).\n\nSolving this equation:\n\n$$q = p + (1-p)^2q$$\n\n$$q - (1-p)^2q = p$$\n\n$$q(1 - (1-p)^2) = p$$\n\n$$q = \\frac{p}{1 - (1-p)^2}$$\n\n$$q = \\frac{p}{2p - p^2}$$\n\n$$q = \\frac{1}{2 - p}$$\n\nLet's calculate this probability for a few values of p:\n\n\n::: {.sourceClojure}\n```clojure\n(def probabilities\n   (map (fn [p] {:p p :probability (probability-a-wins p)})\n        [0.1 0.3 0.5 0.7 0.9]))\n```\n:::\n\n\n\n::: {.sourceClojure}\n```clojure\n(into [] probabilities)\n```\n:::\n\n\n\n::: {.printedClojure}\n```clojure\n[{:p 0.1, :probability 0.5263157894736844}\n {:p 0.3, :probability 0.5882352941176471}\n {:p 0.5, :probability 0.6666666666666666}\n {:p 0.7, :probability 0.7692307692307693}\n {:p 0.9, :probability 0.9090909090909092}]\n\n```\n:::\n\n\n**Interpretation:**\n\n1. When p = 0.5 (fair coin), we get the same result as in part (a): 2/3.\n2. As p increases, A's probability of winning increases, which makes sense as A gets the first chance to flip.\n3. As p approaches 1, A's probability of winning approaches 1, as A would almost certainly win on the first flip.\n4. As p approaches 0, A's probability of winning approaches 1/2, as the game would likely go on for many flips, slightly favoring A who goes first.\n\n\n::: {.sourceClojure}\n```clojure\n(answer \"The probability that A wins when P(head) = p is 1 / (2 - p)\")\n```\n:::\n\n\n> <span style=\"color: black; font-size: 1.5em;\">**The probability that A wins when P(head) = p is 1 / (2 - p)**</span>\n\n**Simulation Verification for Part b:**\n\nLet's create a simulation to verify our formula for different values of p:\n\n\n::: {.sourceClojure}\n```clojure\n(defn simulate-game-b [p]\n   (loop [player :A]\n     (if (< (rand) p)\n       player\n       (recur (if (= player :A) :B :A)))))\n```\n:::\n\n\n\n::: {.sourceClojure}\n```clojure\n(defn simulate-many-games-b [n p]\n   (let [results (repeatedly n #(simulate-game-b p))\n         a-wins (count (filter #(= % :A) results))]\n     (double (/ a-wins n))))\n```\n:::\n\n\n\n::: {.sourceClojure}\n```clojure\n(def simulation-results\n   (for [p [0.1 0.3 0.5 0.7 0.9]]\n     (let [theoretical (probability-a-wins p)\n           simulated (simulate-many-games-b 1000000 p)]\n       {:p p\n        :theoretical theoretical\n        :simulated simulated\n        :difference (- theoretical simulated)})))\n```\n:::\n\n\n\n::: {.sourceClojure}\n```clojure\n(answer \"Simulation results comparing theoretical and simulated probabilities:\")\n```\n:::\n\n\n> <span style=\"color: black; font-size: 1.5em;\">**Simulation results comparing theoretical and simulated probabilities:**</span>\n\n\n::: {.sourceClojure}\n```clojure\n(into [] simulation-results)\n```\n:::\n\n\n\n::: {.printedClojure}\n```clojure\n[{:p 0.1,\n  :theoretical 0.5263157894736844,\n  :simulated 0.526619,\n  :difference -3.032105263155449E-4}\n {:p 0.3,\n  :theoretical 0.5882352941176471,\n  :simulated 0.587536,\n  :difference 6.992941176471312E-4}\n {:p 0.5,\n  :theoretical 0.6666666666666666,\n  :simulated 0.666558,\n  :difference 1.0866666666664582E-4}\n {:p 0.7,\n  :theoretical 0.7692307692307693,\n  :simulated 0.76968,\n  :difference -4.4923076923075733E-4}\n {:p 0.9,\n  :theoretical 0.9090909090909092,\n  :simulated 0.909293,\n  :difference -2.0209090909084626E-4}]\n\n```\n:::\n\n\n**Conclusion:**\n\nWe have derived, implemented, and verified formulas for the probability of player A winning in a coin-flipping game against player B, both for a fair coin and for a coin with an arbitrary probability of heads. The simulation results closely match our theoretical calculations, confirming the accuracy of our formula.\n\nThis problem demonstrates the application of probability in game theory and illustrates how initial advantages (going first) can affect the overall probability of winning in sequential games. It also showcases how simulations can be used to verify theoretical results in probability problems.\n\nAdd the following code for plotting\n\n\n::: {.sourceClojure}\n```clojure\n(def simulation-data\n   (tc/dataset\n    (concat\n     (map #(assoc % :type \"Theoretical\" :probability (:theoretical %)) simulation-results)\n     (map #(assoc % :type \"Simulated\" :probability (:simulated %)) simulation-results))))\n```\n:::\n\n\n\n::: {.sourceClojure}\n```clojure\n(-> simulation-data\n     (haclo/layer-line\n      {:=x :p :=x-title \"P(Head)\" :=title \"Probability of A Winning\"\n       :=y :probability :=y-title \"Probability of A Winning\"\n       :=color :type})\n     (haclo/layer-point\n      {:=x :p       :=y :probability :=color :type}))\n```\n:::\n\n\n\n```{=html}\n<div><script>vegaEmbed(document.currentScript.parentElement, {\"encoding\":{\"x\":{\"field\":\"x\",\"type\":\"nominal\"},\"y\":{\"field\":\"y\",\"type\":\"nominal\"}},\"usermeta\":{\"embedOptions\":{\"renderer\":\"svg\"}},\"width\":400,\"background\":\"floralwhite\",\"layer\":[{\"mark\":{\"type\":\"line\",\"tooltip\":true},\"encoding\":{\"color\":{\"field\":\"type\",\"type\":\"nominal\"},\"x\":{\"field\":\"p\",\"type\":\"quantitative\",\"title\":\"P(Head)\"},\"y\":{\"field\":\"probability\",\"type\":\"quantitative\",\"title\":\"Probability of A Winning\"}},\"data\":{\"values\":\"p,theoretical,simulated,difference,type,probability\\n0.1,0.5263157894736844,0.526619,-3.032105263155449E-4,Theoretical,0.5263157894736844\\n0.3,0.5882352941176471,0.587536,6.992941176471312E-4,Theoretical,0.5882352941176471\\n0.5,0.6666666666666666,0.666558,1.0866666666664582E-4,Theoretical,0.6666666666666666\\n0.7,0.7692307692307693,0.76968,-4.4923076923075733E-4,Theoretical,0.7692307692307693\\n0.9,0.9090909090909092,0.909293,-2.0209090909084626E-4,Theoretical,0.9090909090909092\\n0.1,0.5263157894736844,0.526619,-3.032105263155449E-4,Simulated,0.526619\\n0.3,0.5882352941176471,0.587536,6.992941176471312E-4,Simulated,0.587536\\n0.5,0.6666666666666666,0.666558,1.0866666666664582E-4,Simulated,0.666558\\n0.7,0.7692307692307693,0.76968,-4.4923076923075733E-4,Simulated,0.76968\\n0.9,0.9090909090909092,0.909293,-2.0209090909084626E-4,Simulated,0.909293\\n\",\"format\":{\"type\":\"csv\"}}},{\"mark\":{\"type\":\"circle\",\"tooltip\":true},\"encoding\":{\"color\":{\"field\":\"type\",\"type\":\"nominal\"},\"x\":{\"field\":\"p\",\"type\":\"quantitative\"},\"y\":{\"field\":\"probability\",\"type\":\"quantitative\"}},\"data\":{\"values\":\"p,theoretical,simulated,difference,type,probability\\n0.1,0.5263157894736844,0.526619,-3.032105263155449E-4,Theoretical,0.5263157894736844\\n0.3,0.5882352941176471,0.587536,6.992941176471312E-4,Theoretical,0.5882352941176471\\n0.5,0.6666666666666666,0.666558,1.0866666666664582E-4,Theoretical,0.6666666666666666\\n0.7,0.7692307692307693,0.76968,-4.4923076923075733E-4,Theoretical,0.7692307692307693\\n0.9,0.9090909090909092,0.909293,-2.0209090909084626E-4,Theoretical,0.9090909090909092\\n0.1,0.5263157894736844,0.526619,-3.032105263155449E-4,Simulated,0.526619\\n0.3,0.5882352941176471,0.587536,6.992941176471312E-4,Simulated,0.587536\\n0.5,0.6666666666666666,0.666558,1.0866666666664582E-4,Simulated,0.666558\\n0.7,0.7692307692307693,0.76968,-4.4923076923075733E-4,Simulated,0.76968\\n0.9,0.9090909090909092,0.909293,-2.0209090909084626E-4,Simulated,0.909293\\n\",\"format\":{\"type\":\"csv\"}}}],\"height\":300,\"data\":{\"url\":\"assignments.hw3.q4_files\\/0.csv\",\"format\":{\"type\":\"csv\"}}});</script></div>\n```\n\n\nThe plot above shows the theoretical probability (line) and simulated results (points) for different values of P(Head). As we can see, the simulated results closely follow the theoretical curve, confirming the accuracy of our formula and simulation.\n\n\n::: {.sourceClojure}\n```clojure\n(def difference-data\n  (tc/dataset simulation-results))\n```\n:::\n\n\n\n::: {.sourceClojure}\n```clojure\n(-> difference-data\n     (haclo/layer-line\n      {:=x :p :=x-title \"P(Head)\" :=title \"Difference between Theoretical and Simulated Probabilities\"\n       :=y :difference :=y-title \"Theoretical - Simulated\"}))\n```\n:::\n\n\n\n```{=html}\n<div><script>vegaEmbed(document.currentScript.parentElement, {\"encoding\":{\"x\":{\"field\":\"x\",\"type\":\"nominal\"},\"y\":{\"field\":\"y\",\"type\":\"nominal\"}},\"usermeta\":{\"embedOptions\":{\"renderer\":\"svg\"}},\"width\":400,\"background\":\"floralwhite\",\"layer\":[{\"mark\":{\"type\":\"line\",\"tooltip\":true},\"encoding\":{\"x\":{\"field\":\"p\",\"type\":\"quantitative\",\"title\":\"P(Head)\"},\"y\":{\"field\":\"difference\",\"type\":\"quantitative\",\"title\":\"Theoretical - Simulated\"}},\"data\":{\"values\":\"p,theoretical,simulated,difference\\n0.1,0.5263157894736844,0.526619,-3.032105263155449E-4\\n0.3,0.5882352941176471,0.587536,6.992941176471312E-4\\n0.5,0.6666666666666666,0.666558,1.0866666666664582E-4\\n0.7,0.7692307692307693,0.76968,-4.4923076923075733E-4\\n0.9,0.9090909090909092,0.909293,-2.0209090909084626E-4\\n\",\"format\":{\"type\":\"csv\"}}}],\"height\":300,\"data\":{\"url\":\"assignments.hw3.q4_files\\/1.csv\",\"format\":{\"type\":\"csv\"}}});</script></div>\n```\n\n\nThis second plot shows the difference between the theoretical and simulated probabilities. The closer the line is to zero, the better the simulation matches the theoretical prediction. As we can see, the differences are very small, typically within ±0.005, which indicates a good agreement between theory and simulation.\n\n\n```{=html}\n<div style=\"background-color:grey;height:2px;width:100%;\"></div>\n```\n\n\n\n```{=html}\n<div><pre><small><small>source: <a href=\"https://github.com/adabwana/f24-m6410-hw3/blob/master/src/assignments/hw3/q4.clj\">src/assignments/hw3/q4.clj</a></small></small></pre></div>\n```\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"toc-depth":3,"number-sections":false,"include-in-header":{"text":"<link rel = \"icon\" href = \"data:,\" />"},"output-file":"assignments.hw3.q4.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.57","theme":"cosmo","code-block-background":true,"toc-title-numbers":false,"number-depth":0},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html","revealjs"]}